---
title: 重心分解
documentation_of: //library/graph/tree/centroid_decomposition.hpp
---

# 重心分解

## できること
- 重心分解とは、以下を再帰的に行い、木を階層構造に作り替える
  1. 現在の木から重心を見つける
  1. 重心でポッキリする。（重心を「分解後の木の根」とし、重心を木から取り除く）
  1. 分割した各々の木に対して、1から繰り返す
- 重心で分けるたび部分木のサイズが半分以下になるため、再帰の深さは必ず対数オーダーに収まる
- これにより、「重心分解ツリー」が作られる
  - 元の木における任意の2頂点間のパスは、重心分解ツリーにおける「ある頂点の共通の先祖」を経由するものとして分類できる
  - 木の分割統治ができるため「木上のパスのうち条件 $X$ を満たすものはいくつか？」等が高速で求まる

## 計算量
- 構築: $O(V \log V)$

## 使い方
```cpp
int N, M;
CentroidDecomposition cd(N);
cd.read(M); // グラフ構造体と同様に作成

// 重心分解を実行。戻り値は重心分解ツリー全体の根
int root = cd.build();

// cd.tree に重心分解後の親子関係が格納される
// ex) cd.tree.g[u] には、重心分解ツリーにおける u の子リストが入る
```

